---
title: 组合模式
date: 2018-01-20 20:32:39
tags:
- 组合模式
- 树形结构
categories: 设计模式
---
组合模式是一种处理树形结构的设计模式。
# 结构定义
![设计图](http://img.my.csdn.net/uploads/201209/07/1347030143_6150.jpg)
组合模式的主要功能就是抽象树形结构上的所有节点的属性和方法。然后在客户使用中，对深层结构隐藏。
在树形结构中，可以含有子节点的被称作容器，不可以的被称作叶子。
设计图中的AbstractFile就是抽象类，而Folder是容器，ImageFile、VideoFile、TextFile是叶子。
所有的节点都实现自抽象类中，在客户端看来，所有对象都是抽象类对象。

*透明组合模式：AbstractFile提供默认的容器节点的方法的实现（add, remove, getChild方法），叶子元素不需要实现，从而简化代码。但是这样会造成如果不希望叶子调用容器方法时报错，则需要直接在客户端定义叶子元素而不是抽象类*

*安全组合模式：AbstarctFile不提供容器方法的抽象，只在容器类内部提供这些方法。这样造成的问题，是容器元素不能使用抽象类，否则无法使用其特有的方法。*

# 主要优点
1. 清楚的定义分层次的复杂对象，让客户端忽略层次的差异，方便对整个层次结构进行控制。
2. 客户端一般情况下只需要调用抽象类对象即可完成逻辑操作，简化代码。
3. 增添新的容器和叶子组件都非常方便，完全符合开闭原则。

# 主要缺点
1. 难以对容器中的构建类型进行限制，比如某个容器只能包含某个叶子，使用组合模式很难施加这些约束。

# 适用场景
1. 一个系统中能分离开叶子对象和容器对象，容器对象包含叶子对象。而需求也希望可以忽略它们之间的差距，客户端可以一致对待。
2. 系统面向对象语言开发。